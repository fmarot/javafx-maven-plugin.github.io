<link rel="import" href="polymer.html">

<link rel="import" href="os-selection.html">
<link rel="import" href="build-mechanism-selection.html">
<link rel="import" href="goal-selection.html">

<link rel="import" href="build-jar-goal.html">

<link rel="import" href="configuration-output.html">

<dom-module id="jfx-configurator">
    <template>
        <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--6-col">
                <div class$="{{configuration.selectedOS}}">
                    <configuration-settings>
                        <span class="shortPropertyDescription">Please select the OS of your build-system:</span>
                        <os-selection selectedOS="{{configuration.selectedOS}}"></os-selection>
                        <span class="shortPropertyDescription">What do you want to create?</span>
                        <goal-selection selectedGoal="{{configuration.selectedGoal}}"></goal-selection>
                        <span class="shortPropertyDescription">How do you want to use this plugin?</span>
                        <build-mechanism-selection selectedBuildMechanism="{{configuration.selectedBuildMechanism}}"></build-mechanism-selection>
                        
                        <build-jar-goal configuration="{{configuration}}" mavenProperties="{{mavenProperties}}" cli="jar" lifecycle="build-jar"></build-jar-goal>
                        <!--
                        <build-native-goal configuration="{{configuration}}" mavenProperties="{{mavenProperties}}" cli="native" lifecycle="build-native"></build-native-goal>
                        <build-web-goal configuration="{{configuration}}" mavenProperties="{{mavenProperties}}" cli="web" lifecycle="build-web"></build-web-goal>
                        <generate-key-store-goal configuration="{{configuration}}" mavenProperties="{{mavenProperties}}" cli="generate-key-store"></generate-key-store-goal>
                        -->
                    </configuration-settings>
                </div>
            </div>
            <div class="mdl-cell mdl-cell--6-col">
                <configuration-output configuration="{{configuration}}" mavenProperties="{{mavenProperties}}" version="{{version}}"></configuration-output>
            </div>
        </div>
    </template>
    <script>
        Polymer({
            is: "jfx-configurator",
            properties:{
                version: String,
                configuration:{
                    type:Object,
                    value: function() {
                        return {
                            selectedOS: "none",
                            selectedBuildMechanism: "cli",
                            selectedGoal: "jar"
                        };
                    }
                },
                mavenProperties:{
                    type:Object,
                    value: function() {
                        return {
                            mainClass: {
                                value: "",
                                defaultValue: ""
                            },
                            verbose: {
                                value: false,
                                defaultValue: false
                            },
                            jfxAppOutputDir: {
                                value: "",
                                defaultValue: "$\{project.build.directory\}/jfx/app"
                            },
                            jfxMainAppJarName: {
                                value: "",
                                defaultValue: "${project.build.finalName}-jfx.jar"
                            },
                            deployDir: {
                                value: "",
                                defaultValue: "${project.basedir}/src/main/deploy"
                            },
                            css2bin:{
                                value: false,
                                defaultValue: false
                            },
                            preLoader:{
                                value: "",
                                defaultValue: ""
                            },
                            updateExistingJar:{
                                value: false,
                                defaultValue: false
                            },
                            allPermissions:{
                                value: false,
                                defaultValue: false
                            },
                            addPackagerJar:{
                                value: true,
                                defaultValue: true
                            }
                        };
                    }
                }
            },
            ready: function() {
                function isOS(osLabel){
                    return navigator.appVersion.indexOf(osLabel) !== -1;
                }
                
                // conditionally set selected OS
                if(isOS("Linux")) this.set("configuration.selectedOS", "linux");
                if(isOS("Mac")) this.set("configuration.selectedOS", "macosx");
                if(isOS("Win")) this.set("configuration.selectedOS", "windows");
            }
            /*
            , observers:[
                "somethingChanged(mavenProperties.*)"
            ]
            , somethingChanged: function(event){
                this.set(event.path, event.value);
            }
            */
        });
    </script>
</dom-module>